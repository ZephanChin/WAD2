import{g as R,i as F,a as U,o as Y}from"./index-a7d5cfcc.rqyF9t_j.js";import{g as k,q as G,o as z,w as H,c as $,a as J}from"./index.esm2017.FicD-Q5F.js";const j={apiKey:"AIzaSyALbJJCcRibFqa7HVcadIYAgBBzbTREkiY",authDomain:"hustlersathome-b9bee.firebaseapp.com",databaseURL:"https://hustlersathome-b9bee-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"hustlersathome-b9bee",storageBucket:"hustlersathome-b9bee.appspot.com",messagingSenderId:"447459076084",appId:"1:447459076084:web:f26efa8cd4e33523a63ba1",measurementId:"G-5S6WET94BS"};let b;R().length?b=R()[0]:b=F(j);const q=U(b),K=k(b);var p=[];async function Q(){const n=document.getElementById("purchase-container"),t=q.currentUser;console.log("User is authenticated:",t),Y(q,async s=>{if(s){const e=G($(K,"porders"),H("uid","==",s.uid),z("PlaceDate","desc")),a=await J(e);n.innertext="",a.empty?n.innertext="<p>You do not have any orders.</p>":a.forEach(o=>{const d=o.data();p.push(d),console.log("All orders:",p),P(o.id,d,n)})}else n.innerText="Please log in to see your orders.",setTimeout(()=>{window.location.href="/login.html"},2e3);Z(p)})}function P(n,t,s){const e=document.createElement("Table");e.classList.add("table");const a=document.createElement("tr");a.classList.add("body-ele");const o=document.createElement("td");o.classList.add("text-center"),o.rowspan=2;const d=document.createElement("td"),E=document.createElement("td"),g=document.createElement("td"),f=document.createElement("td");o.classList.add("text-secondary"),E.classList.add("text-secondary"),g.classList.add("text-secondary"),f.classList.add("text-secondary"),o.textContent="Order Number:",d.textContent="",E.textContent="Ordered On",g.textContent="Hustler",f.textContent="Status",a.appendChild(o),a.appendChild(d),a.appendChild(E),a.appendChild(g),a.appendChild(f),e.appendChild(a);const c=document.createElement("tr"),x=document.createElement("td");x.classList.add("text-center","fs-5");const D=document.createElement("td"),y=document.createElement("td");y.classList.add("text-start","fs-5");const T=document.createElement("td");T.classList.add("fs-5");const l=document.createElement("td");l.classList.add("text-start","fs-3","fw-bold"),x.textContent=n.toUpperCase(),D.textContent=" ",y.textContent=t.PlaceDate.toDate().toLocaleDateString(),T.textContent=t.sellaccount,l.textContent=t.status,t.status=="Ongoing"&&l.classList.add("text-warning"),t.status=="Completed"&&l.classList.add("text-success"),t.status=="Cancelled"&&l.classList.add("text-danger"),c.appendChild(x),c.appendChild(D),c.appendChild(y),c.appendChild(T),c.appendChild(l),e.appendChild(c);const L=t.Items;for(const N in L)if(L.hasOwnProperty(N)){const i=L[N],r=document.createElement("tr"),C=document.createElement("td"),S=document.createElement("img");S.classList.add("item-img"),C.align="center",C.rowSpan=2;const V=document.createElement("td"),_=document.createElement("td"),w=document.createElement("td"),B=document.createElement("td");V.classList.add("text-secondary"),_.classList.add("text-secondary"),w.classList.add("text-secondary"),B.classList.add("text-secondary"),S.src=i[4],V.textContent="Item Name",_.textContent="Item Price",w.textContent="Quantity",B.textContent="Item Total Price",C.appendChild(S),r.appendChild(C),r.appendChild(V),r.appendChild(_),r.appendChild(w),r.appendChild(B),e.appendChild(r);const u=document.createElement("tr"),M=document.createElement("td"),O=document.createElement("td"),A=document.createElement("td"),v=document.createElement("td");M.classList.add("align-top","fs-5"),O.classList.add("align-top","fs-5"),A.classList.add("align-top","fs-5"),v.classList.add("align-top","fs-5"),M.textContent=i[0],O.textContent=`SGD ${i[1].toFixed(2)}`,A.textContent=i[2],v.textContent=`SGD ${i[3].toFixed(2)}`,u.appendChild(M),u.appendChild(O),u.appendChild(A),u.appendChild(v),e.appendChild(u)}const I=document.createElement("tr"),m=document.createElement("td");m.classList.add("text-end","fs-2"),m.colSpan=3;const h=document.createElement("td");h.classList.add("text-center","fs-3"),h.colSpan=2,m.textContent="Total Order Price:",h.textContent=`SGD ${t.TotalPrice.toFixed(2)}`,I.appendChild(m),I.appendChild(h),e.appendChild(I),e.classList.add("w-75","border","centered-table"),s.appendChild(e)}function W(){const n=document.getElementById("purchase-container"),t=document.getElementById("startMonth").value,s=document.getElementById("endMonth").value,e=p.filter(a=>{const o=a.PlaceDate.toDate(),d=o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0");return(!t||d>=t)&&(!s||d<=s)});e.length==0?n.innerText="No matching orders":(console.log("filtered orders",e),n.innerText="",e.forEach(a=>P(a.OrderID,a,n)))}const X=document.querySelectorAll(".filter-btn");X.forEach(n=>{n.addEventListener("click",()=>{W()})});const Z=n=>{const t=new Set;n.forEach(e=>{console.log("populate ddl",e.sellaccount),t.add(e.sellaccount)});const s=document.getElementById("storeName");t.forEach(e=>{const a=document.createElement("option");a.value=e,a.textContent=e,s.appendChild(a)})},ee=()=>{const n=document.getElementById("purchase-container"),t=document.getElementById("storeName").value,s=p.filter(e=>t===""||e.sellaccount===t);console.log("HERE",s),n.innerText="",s.forEach(e=>P(e.OrderID,e,n))};document.getElementById("storeName").addEventListener("input",ee);const te=()=>{const n=document.querySelectorAll('input[type="month"]'),t=new Date,s=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0");n.forEach(e=>e.setAttribute("max",s))},ne=()=>{const n=document.getElementById("startMonth").value;document.getElementById("endMonth").setAttribute("min",n)};document.getElementById("startMonth").addEventListener("input",ne);window.onload=Q;te();
