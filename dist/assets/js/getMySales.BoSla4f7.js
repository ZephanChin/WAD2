import{g as v,i as k,a as P,o as $}from"./index-a7d5cfcc.rqyF9t_j.js";import{g as G,q as U,o as Y,w as z,c as j,a as J,d as V,u as D}from"./index.esm2017.FicD-Q5F.js";const H={apiKey:"AIzaSyALbJJCcRibFqa7HVcadIYAgBBzbTREkiY",authDomain:"hustlersathome-b9bee.firebaseapp.com",databaseURL:"https://hustlersathome-b9bee-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"hustlersathome-b9bee",storageBucket:"hustlersathome-b9bee.appspot.com",messagingSenderId:"447459076084",appId:"1:447459076084:web:f26efa8cd4e33523a63ba1",measurementId:"G-5S6WET94BS"};let E;v().length?E=v()[0]:E=k(H);const q=P(E),M=G(E);var N=[];async function K(){const n=document.getElementById("pills-all"),e=document.getElementById("pills-ongoing"),d=document.getElementById("pills-completed"),o=document.getElementById("pills-cancelled");q.currentUser,$(q,async s=>{if(s){const a=U(j(M,"porders"),z("selluid","==",s.uid),Y("PlaceDate","desc")),r=await J(a);if(n.innertext="",e.innertext="",d.innertext="",o.innertext="",r.empty){const l=document.createElement("div");l.classList.add("text-center","my-5","fs-4","fw-bold"),l.textContent="No Orders",n.appendChild(l),e.appendChild(l),d.appendChild(l),o.appendChild(l)}else{r.forEach(t=>{const c=t.data();N.push(c),c.selluid==s.uid&&(b(t.id,c,n),c.status=="Ongoing"&&b(t.id,c,e),c.status=="Completed"&&b(t.id,c,d),c.status=="Cancelled"&&b(t.id,c,o))});const l=document.getElementById("pills-all"),m=document.getElementById("pills-ongoing"),u=document.getElementById("pills-completed"),i=document.getElementById("pills-cancelled");if(l.textContent.trim()===""){const t=document.createElement("div");t.classList.add("text-center","my-5","fs-4","fw-bold"),t.textContent="No Orders",l.appendChild(t)}if(m.textContent.trim()===""){const t=document.createElement("div");t.classList.add("text-center","my-5","fs-4","fw-bold"),t.textContent="No Ongoing Orders",m.appendChild(t)}if(u.textContent.trim()===""){const t=document.createElement("div");t.classList.add("text-center","my-5","fs-4","fw-bold"),t.textContent="No Completed Orders",u.appendChild(t)}if(i.textContent.trim()===""){const t=document.createElement("div");t.classList.add("text-center","my-5","fs-4","fw-bold"),t.textContent="No Cancelled Orders",i.appendChild(t)}}}else salesOrder.innerText="Please log in to see your orders.",setTimeout(()=>{window.location.href="/login.html"},2e3)})}function b(n,e,d){const o=document.createElement("Table");o.classList.add("table");const s=document.createElement("tr"),a=document.createElement("td"),r=document.createElement("td"),l=document.createElement("td"),m=document.createElement("td"),u=document.createElement("td");a.classList.add("text-secondary"),r.classList.add("text-secondary"),l.classList.add("text-secondary"),m.classList.add("text-secondary"),u.classList.add("text-secondary"),a.textContent="Order Number:",r.textContent="Order Date",l.textContent="Customer",m.textContent="Total Order Amount",u.textContent="Status",s.appendChild(a),s.appendChild(r),s.appendChild(l),s.appendChild(m),s.appendChild(u),o.append(s);const i=document.createElement("tr"),t=document.createElement("td"),c=document.createElement("td"),x=document.createElement("td"),y=document.createElement("td"),p=document.createElement("td");t.classList.add("fw-bold","fs-5"),c.classList.add("fw-bold","fs-5"),x.classList.add("fw-bold","fs-5"),y.classList.add("fw-bold","fs-5"),t.textContent=n.toUpperCase(),c.textContent=e.PlaceDate.toDate().toLocaleDateString(),x.textContent=e.account,y.textContent=`SGD ${e.TotalPrice.toFixed(2)}`,p.textContent=e.status,p.classList.add("fs-3","fw-bold","text-center"),e.status=="Ongoing"&&p.classList.add("bg-warning","text-light"),e.status=="Completed"&&p.classList.add("bg-success","text-light"),e.status=="Cancelled"&&p.classList.add("bg-danger","text-light"),i.appendChild(t),i.appendChild(c),i.appendChild(x),i.appendChild(y),i.appendChild(p),o.append(i),o.classList.add("border","w-75","centered-table"),d.appendChild(o),document.createElement("tr");const w=e.Items;for(const S in w){const f=document.createElement("tr");if(w.hasOwnProperty(S)){const C=w[S],I=document.createElement("img");I.classList.add("item-img"),I.src=C[4];const _=document.createElement("td");_.appendChild(I);const A=document.createElement("td");A.textContent=`${C[0]}`;const R=document.createElement("td");R.textContent=`SGD ${C[1].toFixed(2)} x ${C[2]}`;const B=document.createElement("td");B.classList.add("fs-5","fw-bold"),B.textContent=`= SGD ${C[3].toFixed(2)}`,f.appendChild(_),f.appendChild(A),f.appendChild(R),f.appendChild(B),o.appendChild(f)}}const L=document.createElement("tr"),O=document.createElement("td"),T=document.createElement("td"),h=document.createElement("button");h.textContent="âœ“",h.classList.add("btn","btn-outline-success","w-100"),e.status!="Ongoing"&&(h.disabled=!0,h.hidden=!0),O.appendChild(h),O.colSpan=2,h.onclick=()=>F(n,"status","Completed");const g=document.createElement("button");g.textContent="ð¤•",g.classList.add("btn","btn-outline-danger","w-100"),e.status!="Ongoing"&&(g.disabled=!0,g.hidden=!0),T.appendChild(g),T.colSpan=3,g.onclick=()=>F(n,"status","Cancelled"),L.appendChild(O),L.appendChild(T),o.appendChild(L),d.appendChild(o)}const F=async(n,e,d)=>{if(d=="Completed"){if(confirm("Are you sure you want to complete this order?")){console.log(n,e,d);const s=V(M,"porders",n);try{await D(s,{[e]:d}),console.log("Order successfully updated!")}catch(a){console.error("Error updating document: ",a)}location.reload()}}else if(confirm("Are you sure you want to reject this order?")){console.log(n,e,d);const s=V(M,"porders",n);try{await D(s,{[e]:d}),console.log("Order successfully updated!")}catch(a){console.error("Error updating document: ",a)}location.reload()}};function W(){const n=document.getElementById("pills-all"),e=document.getElementById("startMonth").value,d=document.getElementById("endMonth").value,o=N.filter(s=>{const a=s.PlaceDate.toDate(),r=a.getFullYear()+"-"+String(a.getMonth()+1).padStart(2,"0");return console.log("start",e,"order",a,"end",d),(!e||r>=e)&&(!d||r<=d)});o.length==0?n.innerText="No matching orders":(console.log("filtered orders",o),n.innerText="",o.forEach(s=>b(s.OrderID,s,n)))}const Q=document.querySelectorAll(".filter-btn");Q.forEach(n=>{n.addEventListener("click",()=>{W()})});const X=()=>{const n=document.querySelectorAll('input[type="month"]'),e=new Date,d=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0");n.forEach(o=>o.setAttribute("max",d))},Z=()=>{const n=document.getElementById("startMonth").value;document.getElementById("endMonth").setAttribute("min",n)};document.getElementById("startMonth").addEventListener("input",Z);window.onload=K;X();
